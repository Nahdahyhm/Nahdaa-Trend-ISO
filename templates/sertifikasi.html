{% extends "base.html" %}
{% block title %}Sertifikasi{% endblock %}
{% block header %}Data Sertifikasi{% endblock %}
{% block content %}

<style>
  .btn-custom { 
    border-radius: 8px; 
    font-weight: 600; 
    box-shadow: 0px 2px 4px rgba(0,0,0,0.15); 
  }
  .btn-custom-sm { 
    border-radius: 6px; 
    padding: 5px 8px; 
  }
  .btn-custom:hover { 
    opacity: 0.9; 
    transform: translateY(-1px); 
    transition: 0.2s; 
  }

  /* === SLIDE PANEL (KANAN) === */
  .panel-form {
      position: fixed;
      top: 0; /* mulai dari atas layar */
      right: -100%;
      width: 340px;
      height: 100vh; /* selalu setinggi layar penuh */
      background: #f9fbff;
      box-shadow: -6px 0 16px rgba(0,0,0,0.15);
      border-top-left-radius: 18px;
      border-bottom-left-radius: 18px;
      padding: 30px 40px 30px 25px; /* padding-top disesuaikan agar konten mulai di bawah header */
      transition: right 0.35s ease-in-out;
      z-index: 2000;
      overflow-y: auto;
  }

  .panel-form.open {
      right: 0;
  }

  .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      font-size: 18px;
      margin-bottom: 18px;
      color: #0a3d62;
      border-bottom: 2px solid #e3eeff;
      padding-bottom: 10px;
  }

  .panel-close {
      cursor: pointer;
      font-size: 22px;
      color: #0a3d62;
      transition: 0.2s;
  }
  .panel-close:hover {
      color: #007bff;
  }

  .panel-form label {
      font-weight: 500;
      color: #2a3f5f;
      margin-top: 10px;
      margin-bottom: 4px;
      display: block;
  }

  .panel-form input, 
  .panel-form select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #d0d8e0;
      border-radius: 8px;
      background: #fff;
      font-size: 14px;
      margin-bottom: 10px;
      transition: all 0.2s ease;
  }

  .panel-form input:focus,
  .panel-form select:focus {
      border-color: #339cff;
      box-shadow: 0 0 0 2px rgba(51,156,255,0.15);
      outline: none;
  }

  .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 20px;
  }

  .btn-simpan {
      background: linear-gradient(135deg, #00aaff, #007bff);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 8px 14px;
      font-weight: 600;
      transition: 0.2s;
  }
  .btn-simpan:hover {
      background: linear-gradient(135deg, #0092e6, #006ae0);
  }

  .btn-batal {
      background: #e4e8f0;
      color: #333;
      border: none;
      border-radius: 8px;
      padding: 8px 14px;
      font-weight: 600;
      transition: 0.2s;
  }
  .btn-batal:hover {
      background: #d5dae3;
  }

  /* Scrollbar lembut */
  .panel-form::-webkit-scrollbar {
    width: 8px;
  }
  .panel-form::-webkit-scrollbar-thumb {
    background-color: #c7d4e8;
    border-radius: 8px;
  }

  /* tombol tambah */
  .btn-clean-gradient {
    background: linear-gradient(135deg, #007bff, #00c6ff);
    color: white;
    font-weight: 600;
    border: none;
    border-radius: 10px;
    padding: 10px 20px;
    transition: all 0.3s ease;
  }

  .btn-clean-gradient:hover {
    background: linear-gradient(135deg, #0056b3, #0096c7);
    transform: translateY(-1px);
  }

  .btn-clean-gradient:active {
    transform: scale(0.98);
  }

  .table-container {
  width: 100%;
  overflow-x: auto;  /* aktifkan scroll horizontal jika kolom kepanjangan */
  -webkit-overflow-scrolling: touch; /* biar smooth di HP */
}

/* pastikan tabel tetap menyesuaikan */
.table-container table {
  width: 100%;
  border-collapse: collapse;
  table-layout: auto;
}

/* cegah potongan di kolom kanan */
.dataTables_wrapper {
  width: 100% !important;
  overflow-x: visible !important;
}

/* kalau pakai DataTables */
.dataTables_scrollHead,
.dataTables_scrollBody {
  overflow: visible !important;
}

/* optional: tweak biar di HP tetap oke */
@media (max-width: 768px) {
  .table-container {
    margin-bottom: 10px;
  }
  .table-container table {
    min-width: 700px; /* biar tabel tetap bisa digeser */
  }
}

  .card-body {
    overflow-x: visible !important;
    padding-right: 0 !important; /* hindari potongan kanan */
  }

 .table-responsive {
    overflow-x: auto !important;
    width: 100% !important;
    max-width: 100vw; /* biar bisa meluas sampai tepi layar */
  }
  .aksi-buttons {
    display: flex;
    justify-content: center;
    gap: 10px;
  }

.btn-action {
  background-color: #f8f9fa;
  border: none;
  border-radius: 10px;
  padding: 8px 10px;
  cursor: pointer;
  transition: all 0.25s ease;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
}

.btn-action i {
  font-size: 15px;
  color: #4a4a4a;
}

/* Tombol edit */
.btn-action.edit {
  background-color: #e9f5ff;
}

.btn-action.edit i {
  color: #007bff;
}

.btn-action.edit:hover {
  background-color: #007bff;
}

.btn-action.edit:hover i {
  color: white;
}

/* Tombol delete */
.btn-action.delete {
  background-color: #ffe9e9;
}

.btn-action.delete i {
  color: #dc3545;
}

.btn-action.delete:hover {
  background-color: #dc3545;
}

.btn-action.delete:hover i {
  color: white;
}

/* Efek halus saat hover */
.btn-action:hover {
  transform: translateY(-2px);
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
}

table.dataTable {
    border-collapse: collapse !important;
    width: 100%;
    border-radius: 12px;
    overflow: hidden;
    background-color: #ffffff;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    font-family: 'Poppins', sans-serif;
  }

  table.dataTable thead {
    background: linear-gradient(90deg, #0066cc, #0099ff);
    color: white;
  }

  table.dataTable thead th {
    font-weight: 600;
    padding: 12px;
    text-align: left;
  }

  table.dataTable tbody tr:nth-child(even) {
    background-color: #f7faff;
  }

  table.dataTable tbody tr:hover {
    background-color: #e8f2ff;
    transition: 0.3s;
  }

  .dataTables_wrapper .dataTables_filter input {
    border-radius: 8px;
    padding: 6px 10px;
    border: 1px solid #ddd;
  }

  .dataTables_wrapper .dataTables_paginate .paginate_button {
    border-radius: 6px !important;
    padding: 4px 10px !important;
    margin: 2px;
    background-color: #0066cc !important;
    color: #fff !important;
    border: none !important;
  }

  .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
    background-color: #004b99 !important;
  }

  #sertifikasiTable_wrapper {
    width: 100% !important;
    overflow-x: auto !important;
  }

  #sertifikasiTable {
    width: 100% !important;
    table-layout: auto; /* biar kolom menyesuaikan */
    min-width: 1200px; /* jaga agar tabel tidak terlalu sempit di layar kecil */
  }

  #sertifikasiTable thead {
    background: linear-gradient(90deg, #0056b3, #0099ff);
    color: white;
    font-weight: 600;
  }

  #sertifikasiTable tbody tr:nth-child(even) {
    background-color: #f9fcff;
  }

  #sertifikasiTable tbody tr:hover {
    background-color: #e8f3ff;
    transition: 0.3s;
  }

  .dataTables_wrapper .dataTables_filter input {
    border-radius: 6px;
    padding: 6px 10px;
    border: 1px solid #ccc;
  }

  .dataTables_wrapper .dataTables_paginate .paginate_button {
    border-radius: 6px !important;
    background-color: #007bff !important;
    color: #fff !important;
    margin: 2px;
    border: none !important;
  }

  .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
    background-color: #0056b3 !important;
  }

  .dataTables_info {
    font-size: 14px;
    color: #555;
  }

/* === STATUS BADGE (warna lama, ukuran kecil) === */
.status-active,
.status-inactive {
  display: inline-block;
  padding: 2px 8px;       /* lebih tipis */
  font-size: 12px;        /* sedikit lebih kecil */
  font-weight: 600;
  border-radius: 12px;    /* lebih kecil biar proporsional */
  letter-spacing: 0.3px;
  min-width: 70px;        /* diperkecil dari 80px */
  text-align: center;
}

/* Warna khusus */
.status-active {
  background-color: #28a745; /* hijau */
  color: #fff;
}

.status-inactive {
  background-color: #dc3545; /* merah */
  color: #fff;
}

.status-active:hover,
.status-inactive:hover {
  opacity: 0.9;
  transform: scale(1.03);
  transition: 0.2s ease;
}
/* =========================================================
   DARK MODE UNTUK DATA TABLE
   ========================================================= */

body.dark-mode table.dataTable,
body.dark-mode #sertifikasiTable {
  background-color: #1f2937 !important;
  color: #e5e7eb !important;
}

body.dark-mode table.dataTable thead,
body.dark-mode #sertifikasiTable thead {
  background: linear-gradient(90deg, #0f172a, #1e293b) !important;
  color: #f8fafc !important;
}

body.dark-mode table.dataTable thead th {
  color: #f1f5f9 !important;
}

body.dark-mode table.dataTable tbody tr {
  background-color: #1f2937 !important;
}

body.dark-mode table.dataTable tbody tr:nth-child(even) {
  background-color: #111827 !important;
}

body.dark-mode table.dataTable tbody tr:hover {
  background-color: #374151 !important;
  transition: 0.25s ease;
}

/* Input search & dropdown */
body.dark-mode .dataTables_wrapper .dataTables_filter input,
body.dark-mode .dataTables_wrapper .dataTables_length select {
  background-color: #111827 !important;
  border: 1px solid #374151 !important;
  color: #e5e7eb !important;
}

/* Pagination */
body.dark-mode .dataTables_wrapper .dataTables_paginate .paginate_button {
  background-color: #374151 !important;
  color: #fff !important;
  border: none !important;
}

body.dark-mode .dataTables_wrapper .dataTables_paginate .paginate_button.current {
  background-color: #1d4ed8 !important;
  color: white !important;
}

body.dark-mode .dataTables_wrapper .dataTables_info {
  color: #e5e7eb !important;
}

/* Badge status */
body.dark-mode .status-active {
  background-color: #15803d !important;
}

body.dark-mode .status-inactive {
  background-color: #b91c1c !important;
}

/* Panel (form slide kanan) */
body.dark-mode .panel-form {
  background: #1f2937 !important;
  color: #e5e7eb !important;
  box-shadow: -6px 0 16px rgba(0,0,0,0.4) !important;
}

body.dark-mode .panel-form input,
body.dark-mode .panel-form select {
  background: #111827 !important;
  border: 1px solid #374151 !important;
  color: #e5e7eb !important;
}

body.dark-mode .panel-header {
  color: #f1f5f9 !important;
  border-bottom: 2px solid #475569 !important;
}
/* ============================
   DARK MODE - DATATABLES
   ============================ */
[data-theme="dark"] table.dataTable {
  background-color: #1e1e1e !important;
  color: #e5e5e5 !important;
  border-color: #333 !important;
}

/* Header */
[data-theme="dark"] table.dataTable thead th {
  background-color: #2a2a2a !important;
  color: #ffffff !important;
  border-bottom: 2px solid #444 !important;
}

/* Body cells */
[data-theme="dark"] table.dataTable tbody td {
  background-color: #1d1d1d !important;
  color: #e5e5e5 !important;
  border-color: #333 !important;
}

/* Row hover */
[data-theme="dark"] table.dataTable tbody tr:hover {
  background-color: #2c2c2c !important;
}

/* Search bar */
[data-theme="dark"] .dataTables_filter input {
  background: #2a2a2a !important;
  color: #fff !important;
  border: 1px solid #555 !important;
}

/* Page number buttons */
[data-theme="dark"] .dataTables_paginate .paginate_button {
  background: #2a2a2a !important;
  color: #fff !important;
  border: 1px solid #444 !important;
}

[data-theme="dark"] .dataTables_paginate .paginate_button.current {
  background: #0d6efd !important; /* biru bootstrap */
  color: #fff !important;
}

/* Info text & showing text */
[data-theme="dark"] .dataTables_info {
  color: #bbb !important;
}

/* Length menu dropdown */
[data-theme="dark"] .dataTables_length select {
  background: #2a2a2a !important;
  color: #fff !important;
  border: 1px solid #555 !important;
}
/* ============================
   DARK MODE - FORM
   ============================ */
[data-theme="dark"] .panel-form,
[data-theme="dark"] .panel-form * {
  color: #eaeaea !important;
}

/* Panel / card form */
[data-theme="dark"] #panelForm {
  background: #1e1e1e !important;
  border-left: 1px solid #333 !important;
}

/* Header panel */
[data-theme="dark"] #panelForm .panel-header {
  background: #2a2a2a !important;
  color: #fff !important;
  border-bottom: 1px solid #444 !important;
}

/* Semua input */
[data-theme="dark"] input[type="text"],
[data-theme="dark"] input[type="number"],
[data-theme="dark"] input[type="date"],
[data-theme="dark"] input[type="email"],
[data-theme="dark"] textarea,
[data-theme="dark"] select {
  background: #2a2a2a !important;
  color: #fff !important;
  border: 1px solid #555 !important;
  border-radius: 6px;
}

/* Placeholder */
[data-theme="dark"] input::placeholder,
[data-theme="dark"] textarea::placeholder {
  color: #aaa !important;
}

/* Focus state */
[data-theme="dark"] input:focus,
[data-theme="dark"] textarea:focus,
[data-theme="dark"] select:focus {
  border-color: #0d6efd !important;
  outline: none !important;
  box-shadow: 0 0 4px rgba(13, 110, 253, 0.5) !important;
}

/* Tombol Simpan & Batal */
[data-theme="dark"] #panelForm button {
  background-color: #0d6efd !important;
  color: #fff !important;
  border: none !important;
}

[data-theme="dark"] #panelForm button:hover {
  background-color: #0b5ed7 !important;
}

/* Scrollbar dark */
[data-theme="dark"] #panelForm::-webkit-scrollbar {
  width: 8px;
}
[data-theme="dark"] #panelForm::-webkit-scrollbar-thumb {
  background: #555;
  border-radius: 10px;
}
[data-theme="dark"] #panelForm::-webkit-scrollbar-track {
  background: #2a2a2a;
}
</style>



<div class="d-flex justify-content-start mb-4">
  <button type="button" class="btn btn-clean-gradient" id="tambahBtn">
    <i class="bi bi-plus-circle me-2"></i> Tambah Sertifikasi
  </button>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <div class="table-responsive" style="overflow-x:auto; max-width:100%;">
      <table class="table table-bordered table-striped" id="sertifikasiTable">
        <thead class="table-primary text-center">
          <tr>
            <th>No</th>
            <th>Nama Client</th>
            <th>Jenis ISO</th>
            <th>No Sertifikat</th>
            <th>Bidang Usaha</th>
            <th>Status</th>
            <th>Kota</th>
            <th>Alamat</th>
            <th>Tgl Awal</th>
            <th>Tgl Akhir</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody>
          {% for s in sertifikasi %}
          <tr class="align-middle">
            <td>{{ loop.index }}</td>
            <td>{{ s[1] }}</td>
            <td>{{ s[2] }}</td>
            <td>{{ s[3] }}</td>
            <td>{{ s[6] }}</td>
            <td>
              {% if s[7] == 'Active' %}
              <span class="status-active">Active</span>
              {% else %}
              <span class="status-inactive">Deactive</span>
              {% endif %}
            </td>
            <td>{{ s[8] }}</td>
            <td>{{ s[9] }}</td>
            <td>{{ s[10] }}</td>
            <td>{{ s[11] }}</td>
            <td class="aksi text-center">
              <div class="aksi-buttons">
                <button class="btn-action edit" onclick="openEdit({{ s[0] }})"><i class="fa fa-pen"></i></button>
                <button class="btn-action delete" onclick="deleteSert({{ s[0] }})"><i class="fa fa-trash"></i></button>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- === PANEL KANAN (FORM TAMBAH) === -->
<div id="panelForm" class="panel-form">
  <div class="panel-header">
      Tambah Sertifikasi
      <span class="panel-close" onclick="closePanel()">&times;</span>
  </div>

  <form id="formSertifikasi">
      <input type="hidden" id="id_sert">
      <label for="nama_client">Nama Client</label>
      <input type="text" id="nama_client" class="form-control" placeholder="Nama Client">

      <label for="jenis_iso">Jenis ISO</label>
        <select id="jenis_iso" name="jenis_iso" class="form-control">
          <option value="">-- Pilih Jenis ISO --</option>
          <option>GMP</option>
          <option>GDP</option>
          <option>HACCP</option>
          <option>ISO 13485:2016</option>
          <option>ISO 14001:2015</option>
          <option>ISO 22000:2018</option>
          <option>ISO 27001:2022</option>
          <option>ISO 45001:2018</option>
          <option>ISO 9001:2015</option>
          <option>OHSAS 18001:2007</option>
          <option>SMK3</option>
          <option>SNI</option>
          <option>BRCGS</option>
          <option>Halal</option>
          <option>Sertifikasi Kosher</option>
          <option>FSC/SVLK</option>
          <option>FSA YUM</option>
          <option>C-TPAT</option>
          <option>Fair Trade</option>
          <option>Organik</option>
        </select>

      <label for="no_cert">No Sertifikat</label>
      <input type="text" id="no_cert" class="form-control">

      <label for="">Jenis EA</label>
      <select id="mc_type" name="mc_type" class="form-control">      
        <option value="">-- Pilih Type --</option>
        {% for t in mc_types %}
        <option value="{{ t }}">{{ t }}</option>
        {% endfor %}
      </select>              

      <label for="">Codes EA</label>
      <select id="mc_code" name="mc_code" class="form-control">      
        <option value="">-- Pilih Kode --</option>
        </select>

      <label for="bidang_usaha">Bidang Usaha</label>
      <input type="text" name="bidang_usaha" id="bidang_usaha" class="form-control" readonly>

      <label for="">Kota</label>
      <input type="text" id="kota" class="form-control">

      <label for="">Alamat</label>
      <input type="text" id="alamat" class="form-control">

      <label for="tgl_awal">Tanggal Awal</label>
      <input type="date" id="tgl_awal" class="form-control">

      <label for="tgl_akhir">Tanggal Akhir</label>
      <input type="date" id="tgl_akhir" class="form-control">

      <div class="form-actions">
          <button type="button" class="btn-batal" onclick="closePanel()">Batal</button>
          <button type="button" class="btn-simpan" onclick="saveSertifikasi()">Simpan</button>
      </div>
  </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
<script>
   $(document).ready(function() {
    $('#sertifikasiTable').DataTable({
      scrollX: true, // <=== tambahkan agar tabel bisa meluas penuh
      autoWidth: false,
      "pageLength": 5,
      "lengthMenu": [5, 10, 25, 50, 100],
      "language": {
        "lengthMenu": "Tampilkan _MENU_ data per halaman",
        "search": "Cari:",
        "paginate": {
          "previous": "Sebelumnya",
          "next": "Berikutnya"
        },
        "info": "Menampilkan _START_ - _END_ dari _TOTAL_ data"
      }
    });

    // Pastikan wrapper tabel lebar penuh
    $('.dataTables_wrapper').css({
      'overflow-x': 'auto',
      'width': '100%'
    });
  });


  // === PANEL FORM ===
  const panel = document.getElementById('panelForm');
  const tambahBtn = document.getElementById('tambahBtn');
  let editMode = false; // untuk cek apakah sedang edit

  tambahBtn.addEventListener('click', () => {
    $('#formSertifikasi')[0].reset();
    $('#panelForm .panel-header').text('Tambah Sertifikasi');
    panel.classList.add('open');
    editMode = false;
  });

  function closePanel() {
    panel.classList.remove('open');
  }

  // === LOAD BIDANG USAHA === 
  function loadBidangUsaha() {
    let code = document.getElementById("mc_code").value;
    if (!code) return;

    fetch(`/sertifikasi/get_bidang_usaha/${code}`)
        .then(res => res.json())
        .then(data => {
            document.getElementById("bidang_usaha").value = data[0] || "";
        });
}

  // === SIMPAN (TAMBAH / EDIT) ===
  function saveSertifikasi() {
    let formData = {
      id_sert: $('#id_sert').val(),
      nama_client: $('#nama_client').val(),
      jenis_iso: $('#jenis_iso').val(),
      no_cert: $('#no_cert').val(),
      mc_type: $('#mc_type').val(),
      mc_code: $('#mc_code').val(),
      bidang_usaha: $('#bidang_usaha').val(),
      kota: $('#kota').val(),
      alamat: $('#alamat').val(),   
      tgl_awal: $('#tgl_awal').val(),
      tgl_akhir: $('#tgl_akhir').val(),
    };

    // validasi cepat
    if (!formData.nama_client || !formData.jenis_iso || !formData.no_cert) {
      Swal.fire({
        icon: 'warning',
        title: 'Data belum lengkap!',
        text: 'Harap isi semua kolom wajib sebelum menyimpan.'
      });
      return
    };

    $.ajax({
      url: '/sertifikasi/save',
      type: 'POST',
      contentType: 'application/json',
      data: JSON.stringify(formData),
      success: function () {
        Swal.fire('Berhasil!', 'Data berhasil disimpan.', 'success').then(() => location.reload());
    
      },
      error: function () {
        Swal.fire({
          icon: 'error',
          title: 'Gagal!',
          text: 'Terjadi kesalahan saat menyimpan data.'
        });
      }
    });
  }

  // === EDIT DATA ===
  function openEdit(id) {
    $.get('/sertifikasi/get/' + id, function (data) {
      $('#panelForm .panel-header').text('Edit Sertifikasi');
      $('#nama_client').val(data.nama_client);
      $('#jenis_iso').val(data.jenis_iso);
      $('#no_cert').val(data.no_cert);

      // 1 set mc_type terlebih dahulu
      $("#mc_type").val(data.mc_type).trigger("change");

      // 2ï¸ setelah code selesai dimuat, pilih mc_code
      setTimeout(() => {
        $("#mc_code").val(data.mc_code).trigger("change");
      }, 300);
    
      $('#kota').val(data.kota);
      $('#alamat').val(data.alamat);
      $('#tgl_awal').val(data.tgl_awal);
      $('#tgl_akhir').val(data.tgl_akhir);
      $('#id_sert').val(data.id_sert);
      panel.classList.add('open');
      editMode = true;
    });
  }

  // === HAPUS DATA ===
  function deleteSert(id) {
    Swal.fire({
      title: "Yakin menghapus?",
      text: "Data akan dihapus permanen!",
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: '#d33',
      cancelButtonColor: '#6c757d',
      confirmButtonText: 'Ya, hapus!'
    }).then((result) => {
      if (result.isConfirmed) {
        $.post('/sertifikasi/delete/' + id, {}, function (data) {
          if (data.status === 'success') {
            Swal.fire({
              icon: 'success',
              title: 'Terhapus!',
              text: 'Data berhasil dihapus.',
              timer: 1500,
              showConfirmButton: false
            }).then(() => {
              location.reload();
            });
          } else {
            Swal.fire('Gagal!', 'Data tidak dapat dihapus.', 'error');
          }
        });
      }
    });
  }

  $("#mc_type").change(function () {
    let type = $(this).val();

    $("#mc_code").html('<option value="">-- Pilih Code --</option>');
    $("#bidang_usaha").val("");

    if (type) {
      $.get("/sertifikasi/get_code_by_type/" + type, function (data) {
        data.forEach(code => {
          $("#mc_code").append(`<option value="${code}">${code}</option>`);
        });
      });
    }
  });
  
  $("#mc_code").change(function () {
    let mc_type = $("#mc_type").val();
    let mc_code = $(this).val();

    if (mc_type && mc_code) {
      $.get("/sertifikasi/get_description",
        { mc_type: mc_type, mc_code: mc_code },
        function (desc) {
          $("#bidang_usaha").val(desc);
        }
      );
    } else {
      $("#bidang_usaha").val("");
    }
  });
</script>

{% endblock %}