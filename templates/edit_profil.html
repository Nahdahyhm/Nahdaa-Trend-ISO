{% extends "base.html" %}
{% block title %}Edit Profil{% endblock %}
{% block header %}Edit Profil{% endblock %}

{% block content %}

<style>
  .profile-container {
    background: #ffffff;
    padding: 40px;
    border-radius: 18px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.05);
  }

  .avatar-box {
    background: #f5f7fc;
    border-radius: 20px;
    width: 260px;
    height: 260px;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    overflow: hidden;
  }

  .avatar-box img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .form-control-modern {
    background: #f8f9fd;
    border: 1px solid #e7e9f3;
    padding: 12px 18px;
    border-radius: 12px;
    height: 48px;
  }

  .btn-save {
    background: #2f3daa;
    color: white;
    padding: 12px 35px;
    border-radius: 12px;
    border: none;
  }

  .btn-cancel {
    border: 2px solid #2f3daa;
    padding: 12px 35px;
    border-radius: 12px;
    background: white;
    color: #2f3daa;
  }

  @media (max-width: 768px) {
    .avatar-box { width: 200px; height: 200px; }
  }
  /* ============================
   DARK MODE VERSION
   Saat <html data-theme="dark">
============================ */

html[data-theme="dark"] .profile-container {
  background: #1f2430;                    /* container gelap */
  box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}

html[data-theme="dark"] .avatar-box {
  background: #2a313f;                    /* box foto */
}

html[data-theme="dark"] .form-control-modern {
  background: #2a313f;
  border: 1px solid #424b5c;
  color: #e5e7ef;
}

html[data-theme="dark"] .form-control-modern::placeholder {
  color: #7f8899;
}

html[data-theme="dark"] label {
  color: #e5e7ef;
}

html[data-theme="dark"] small.text-muted {
  color: #8d93a5 !important;
}

html[data-theme="dark"] .btn-cancel {
  background: transparent;
  color: #aab4ff;
  border-color: #4c57c7;
}

html[data-theme="dark"] .btn-save {
  background: #4c57c7;
  color: white;
}
/* ============================
   DARK MODE - INPUT FILE
============================ */
html[data-theme="dark"] input[type="file"] {
  background-color: #2a313f;
  border: 1px solid #424b5c;
  color: #dfe3eb;
}

html[data-theme="dark"] input[type="file"]::file-selector-button {
  background: #4c57c7;
  color: #ffffff;
  border: none;
  padding: 8px 16px;
  margin-right: 15px;
  border-radius: 0 !important;
  cursor: pointer;
}

html[data-theme="dark"] input[type="file"]::file-selector-button:hover {
  background: #626ef5;
}
</style>

<div class="container mt-4">
  <div class="profile-container row">
    <form action="{{ url_for('user.update_profile') }}" 
          method="POST" 
          enctype="multipart/form-data"
          class="row w-100">
      
      <!-- FOTO -->
      <div class="col-md-4 d-flex flex-column align-items-center mb-3">
        <div class="avatar-box">
          <img id="preview"
               src="{% if user['photo'] %}{{ url_for('static', filename='uploads/' ~ user['photo']) }}{% else %}{{ url_for('static', filename='uploads/default.png') }}{% endif %}"
               alt="Foto">
        </div>
        <input type="file" 
               accept="image/*" 
               class="form-control mt-3" 
               name="photo" 
               onchange="previewImage(event)">
        <small class="text-muted mt-2">
          Maks file: 2MB â€¢ Format: JPG / PNG
        </small>
      </div>

      <!-- FORM -->
      <div class="col-md-8">

        <div class="mb-3">
          <label class="form-label fw-semibold">Username</label>
          <input type="text" 
                 class="form-control-modern w-100" 
                 name="username" 
                 value="{{ user['username'] }}" >
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold">Password</label>
          <input type="password" 
                 id="password" 
                 name="password" 
                 class="form-control-modern w-100" 
                 placeholder="Kosongkan jika tidak ingin mengubah">
        </div>

        <div class="d-flex gap-3 mt-4">
          <button type="submit" class="btn-save">Save</button>
          <a href="{{ url_for('dashboard.dashboard') }}" class="btn-cancel">Cancel</a>
        </div>

      </div>
    </form>

  </div>
</div>

<script>
  function previewImage(event) {
    const input = event.target;
    if (input.files && input.files[0]) {
      const image = document.getElementById('preview');
      image.src = URL.createObjectURL(input.files[0]);
      image.onload = () => URL.revokeObjectURL(image.src); // bersihkan memory
    }
  }
</script>

{% endblock %}